

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qmetro.qmtensor.classes package &mdash; QMetro++ 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="qmetro.qmtensor.creators package" href="qmetro.qmtensor.creators.html" />
    <link rel="prev" title="qmetro.qmtensor package" href="qmetro.qmtensor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            QMetro++
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="qmetro.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="qmetro.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="qmetro.bounds.html">qmetro.bounds package</a></li>
<li class="toctree-l3"><a class="reference internal" href="qmetro.iss_opt.html">qmetro.iss_opt package</a></li>
<li class="toctree-l3"><a class="reference internal" href="qmetro.param_channel.html">qmetro.param_channel package</a></li>
<li class="toctree-l3"><a class="reference internal" href="qmetro.protocols.html">qmetro.protocols package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="qmetro.qmtensor.html">qmetro.qmtensor package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="qmetro.qmtensor.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="qmetro.qmtensor.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="qmetro.qmtensor.html#module-qmetro.qmtensor.operations">qmetro.qmtensor.operations module</a></li>
<li class="toctree-l4"><a class="reference internal" href="qmetro.qmtensor.html#module-qmetro.qmtensor">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qmetro.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="qmetro.html#module-qmetro.consts">qmetro.consts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="qmetro.html#module-qmetro.qtools">qmetro.qtools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="qmetro.html#module-qmetro.utils">qmetro.utils module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMetro++</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="qmetro.html">Documentation</a></li>
          <li class="breadcrumb-item"><a href="qmetro.qmtensor.html">qmetro.qmtensor package</a></li>
      <li class="breadcrumb-item active">qmetro.qmtensor.classes package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/qmetro.qmtensor.classes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qmetro-qmtensor-classes-package">
<h1>qmetro.qmtensor.classes package<a class="headerlink" href="#qmetro-qmtensor-classes-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-qmetro.qmtensor.classes.tensors">
<span id="qmetro-qmtensor-classes-tensors-module"></span><h2>qmetro.qmtensor.classes.tensors module<a class="headerlink" href="#module-qmetro.qmtensor.classes.tensors" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">ConstTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spaces:</span> <span class="pre">list[~collections.abc.Hashable],</span> <span class="pre">choi:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;,</span> <span class="pre">array:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">output_spaces:</span> <span class="pre">list[~collections.abc.Hashable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">comb_structure:</span> <span class="pre">list[tuple[list[~collections.abc.Hashable],</span> <span class="pre">list[~collections.abc.Hashable]]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralTensor</span></code></a></p>
<p>Class of tensors that are constant during the optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces.</p></li>
<li><p><strong>choi</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Choi matrix which from which the tensor will be constructed. If
None then it will be initialized from the array argument, by
default None.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>array</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor as numpy array, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Tensor output spaces, by default None.</p></li>
<li><p><strong>comb_structure</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Comb (causal) structure in a form of [(input_0, output_0),
(input_1, output_1), …] where input_i (output_i) is a list
of input (output) spaces of the i-th tooth.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>comb_structure</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></dt><dd><p>Dimensions of the tensor spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dim</span></code></dt><dd><p>Input dimension, that is the product of the all input spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_spaces</span></code></dt><dd><p>List of the input spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_choi_like</span></code></dt><dd><p>Whether the tensor is Choi-like.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_comb</span></code></dt><dd><p>Whether the tensor has comb (causal) structure.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_dim</span></code></dt><dd><p>Output dimension, that is the product of the all output spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_spaces</span></code></dt><dd><p>List of the output spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></dt><dd><p>Tensor shape, that is index ranges of self.spaces.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi" title="qmetro.qmtensor.classes.tensors.ConstTensor.choi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi</span></code></a>(spaces)</p></td>
<td><p>Compute Choi matrix for the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_T" title="qmetro.qmtensor.classes.tensors.ConstTensor.choi_T"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_T</span></code></a>(*spaces[, full])</p></td>
<td><p>Computes partial transposition of Choi-like tensor and for other tensors it does transpose-like reshuffling of entries on physcial spaces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_matmul" title="qmetro.qmtensor.classes.tensors.ConstTensor.choi_matmul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_matmul</span></code></a>(other)</p></td>
<td><p>For two Choi-like tensors compute the tensor of their Choi matrices multiplication.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_trace" title="qmetro.qmtensor.classes.tensors.ConstTensor.choi_trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_trace</span></code></a>(*spaces[, full])</p></td>
<td><p>For Choi-like tensor compute partial trace of the Choi matrix and return its tensor form.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_transpose" title="qmetro.qmtensor.classes.tensors.ConstTensor.choi_transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_transpose</span></code></a>(*spaces[, full])</p></td>
<td><p>Computes partial transposition of Choi-like tensor and for other tensors it does transpose-like reshuffling of entries on physcial spaces.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">contr</span></code>(*others)</p></td>
<td><p>Contract tensors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.copy" title="qmetro.qmtensor.classes.tensors.ConstTensor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.from_mps" title="qmetro.qmtensor.classes.tensors.ConstTensor.from_mps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mps</span></code></a>(array, spaces[, sdict, ...])</p></td>
<td><p>Computess a constant tensor of density MPO element from the array of MPS element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.krauses" title="qmetro.qmtensor.classes.tensors.ConstTensor.krauses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">krauses</span></code></a>([input_spaces, output_spaces])</p></td>
<td><p>Computes Kraus operators of the Choi matrix of the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kron</span></code>(*others)</p></td>
<td><p>For Choi-like tensors it computes their Kronecker product and for other tensors it is just contraction where there are no doubled indices (no index gets contracted).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.reorder" title="qmetro.qmtensor.classes.tensors.ConstTensor.reorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reorder</span></code></a>(new_spaces)</p></td>
<td><p>Change the order of spaces.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.respace" title="qmetro.qmtensor.classes.tensors.ConstTensor.respace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">respace</span></code></a>([spaces, space_map, sdict, name, ...])</p></td>
<td><p>Make a copy of self but with renamed spaces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.square_without" title="qmetro.qmtensor.classes.tensors.ConstTensor.square_without"><code class="xref py py-obj docutils literal notranslate"><span class="pre">square_without</span></code></a>(spaces)</p></td>
<td><p>Computes Choi matrix square on spaces different than given spaces.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.to_mps" title="qmetro.qmtensor.classes.tensors.ConstTensor.to_mps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_mps</span></code></a>(spaces[, cutoff])</p></td>
<td><p>Converts tensor form of density MPO component into MPS component(s).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.to_qchannel" title="qmetro.qmtensor.classes.tensors.ConstTensor.to_qchannel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_qchannel</span></code></a>([input_spaces, output_spaces])</p></td>
<td><p>Returns a quantum channel of the Choi matrix of the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor.update_choi" title="qmetro.qmtensor.classes.tensors.ConstTensor.update_choi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_choi</span></code></a>(spaces, matrix)</p></td>
<td><p>Set tensor entries to make it Choi matrix equal to the given matrix.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.choi">
<span class="sig-name descname"><span class="pre">choi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.choi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi" title="Link to this definition"></a></dt>
<dd><p>Compute Choi matrix for the Choi-like tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – List of spaces defining the order of spaces of the result.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>matrix</strong> – Choi matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.choi_T">
<span class="sig-name descname"><span class="pre">choi_T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.choi_T"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_T" title="Link to this definition"></a></dt>
<dd><p>Computes partial transposition of Choi-like tensor and for other
tensors it does transpose-like reshuffling of entries on
physcial spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True tranposes all spaces, by default False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transpostion</strong> – Tensor of the transposed matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.choi_matmul">
<span class="sig-name descname"><span class="pre">choi_matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.choi_matmul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_matmul" title="Link to this definition"></a></dt>
<dd><p>For two Choi-like tensors compute the tensor of their Choi matrices
multiplication.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><em>ConstTensor</em></a>) – Tensor to multiply.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>product</strong> – Tensor of the product.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.choi_trace">
<span class="sig-name descname"><span class="pre">choi_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.choi_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_trace" title="Link to this definition"></a></dt>
<dd><p>For Choi-like tensor compute partial trace of the Choi matrix
and return its tensor form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong><strong>[</strong><strong>0</strong><strong>...</strong><strong>*</strong><strong>]</strong> (<em>Hashable</em>) – Spaces to be traced out.</p></li>
<li><p><strong>full</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True then computes the trace over all spaces and returns
a complex number, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Tensor form of the result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor | complex</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.choi_transpose">
<span class="sig-name descname"><span class="pre">choi_transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.choi_transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.choi_transpose" title="Link to this definition"></a></dt>
<dd><p>Computes partial transposition of Choi-like tensor and for other
tensors it does transpose-like reshuffling of entries on
physcial spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True tranposes all spaces, by default False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transpostion</strong> – Tensor of the transposed matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.contr_count">
<span class="sig-name descname"><span class="pre">contr_count</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.contr_count" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.copy" title="Link to this definition"></a></dt>
<dd><p>Make a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy</strong> – Tensor copy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.from_mps">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">array:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">spaces:</span> <span class="pre">list[~collections.abc.Hashable],</span> <span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;,</span> <span class="pre">output_spaces:</span> <span class="pre">list[~collections.abc.Hashable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.from_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.from_mps" title="Link to this definition"></a></dt>
<dd><p>Computess a constant tensor of density MPO element from
the array of MPS element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.ndarray</em>) – Array of MPS element.</p></li>
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Array’s order of spaces.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Output spaces, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – New tensor name, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Density MPO element.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.krauses">
<span class="sig-name descname"><span class="pre">krauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.krauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.krauses" title="Link to this definition"></a></dt>
<dd><p>Computes Kraus operators of the Choi matrix of the Choi-like
tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Input spaces. If None then self.input_spaces, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Output spaces. If None then self.output_spaces, by default
None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>krauses</strong> – List of Kraus operators.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.name_prefix">
<span class="sig-name descname"><span class="pre">name_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'CONST</span> <span class="pre">TENSOR</span> <span class="pre">'</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.name_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.reorder">
<span class="sig-name descname"><span class="pre">reorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.reorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.reorder" title="Link to this definition"></a></dt>
<dd><p>Change the order of spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Spaces names in the new order.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – self</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.respace">
<span class="sig-name descname"><span class="pre">respace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><span class="pre">SpaceDict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.respace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.respace" title="Link to this definition"></a></dt>
<dd><p>Make a copy of self but with renamed spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
self.spaces[i] -&gt; spaces[i]. If None then change of spaces
will be carried out using space_map, by default None.</p></li>
<li><p><strong>space_map</strong> (<em>Callable</em><em>[</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
space -&gt; space_map(space), by default None</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Space dictionary of the copy. If None then it will be
self.sdict, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the copy. If None then it will be self.name, by
default None.</p></li>
<li><p><strong>make_copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to make a copy of <cite>self.array</cite>, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>copy</strong> – New tensor with renamed spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.square_without">
<span class="sig-name descname"><span class="pre">square_without</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.square_without"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.square_without" title="Link to this definition"></a></dt>
<dd><p>Computes Choi matrix square on spaces different than given spaces.</p>
<p>For tensor T[a0, a1, a2, a3] and spaces [a0, a1] computes a new
tensor U such that</p>
<blockquote>
<div><p>U[a0, a1].choi == T[a0, a1].choi &#64; T[a0, a1].choi.</p>
</div></blockquote>
<p>It can be used to compute matrix squares for tensor networks. For
example for physcial spaces p0, p1 and bond space b0 and tensors:</p>
<blockquote>
<div><p>V[p0, p1] = T[p0, b0] * U[b0, p1],</p>
</div></blockquote>
<p>it satifies:</p>
<blockquote>
<div><p>V.choi([p0, p1]) &#64; V.choi([p0, p1]) == (T.square_wiyhout([b0])
* U.square_wiyhout([b0])).choi([p0, p1]).</p>
</div></blockquote>
<p>Note that this requires T.square_wiyhout([b0]) to have two b0
spaces. This is solved by adding b0’ space using SpaceDictionar
primed method.</p>
<p>Only physical spaces can be squared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Spaces to be omitted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Matrix square without given spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.to_mps">
<span class="sig-name descname"><span class="pre">to_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.to_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.to_mps" title="Link to this definition"></a></dt>
<dd><p>Converts tensor form of density MPO component into MPS
component(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Order of spaces for the result.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff for small eigenvalues. The default is 1e-10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of MPS components. Each component is a numpy array of
shape (sqrt(range_s) for s in spaces). For pure states it
should be a list of length 1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.to_qchannel">
<span class="sig-name descname"><span class="pre">to_qchannel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.to_qchannel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.to_qchannel" title="Link to this definition"></a></dt>
<dd><p>Returns a quantum channel of the Choi matrix of the Choi-like
tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Input spaces. If None then self.input_spaces, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Output spaces. If None then self.output_spaces, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>channel</strong> – Quantum channel of the Choi matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[np.ndarray], <a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ConstTensor.update_choi">
<span class="sig-name descname"><span class="pre">update_choi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ConstTensor.update_choi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ConstTensor.update_choi" title="Link to this definition"></a></dt>
<dd><p>Set tensor entries to make it Choi matrix equal to the given
matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Spaces names,</p></li>
<li><p><strong>matrix</strong> (<em>np.ndarray</em>) – Choi matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">GeneralTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spaces:</span> <span class="pre">list[~collections.abc.Hashable],</span> <span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">output_spaces:</span> <span class="pre">list[~collections.abc.Hashable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">comb_structure:</span> <span class="pre">list[tuple[list[~collections.abc.Hashable],</span> <span class="pre">list[~collections.abc.Hashable]]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generalized tensor class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Tensor output spaces, by default None</p></li>
<li><p><strong>comb_structure</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Comb (causal) structure in a form of [(input_0, output_0),
(input_1, output_1), …] where input_i (output_i) is a list
of input (output) spaces of the i-th tooth.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>comb_structure</strong></dt><dd></dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.dimensions" title="qmetro.qmtensor.classes.tensors.GeneralTensor.dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></a></dt><dd><p>Dimensions of the tensor spaces.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.input_dim" title="qmetro.qmtensor.classes.tensors.GeneralTensor.input_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dim</span></code></a></dt><dd><p>Input dimension, that is the product of the all input spaces dimensions.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.input_spaces" title="qmetro.qmtensor.classes.tensors.GeneralTensor.input_spaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_spaces</span></code></a></dt><dd><p>List of the input spaces.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.is_choi_like" title="qmetro.qmtensor.classes.tensors.GeneralTensor.is_choi_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_choi_like</span></code></a></dt><dd><p>Whether the tensor is Choi-like.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.is_comb" title="qmetro.qmtensor.classes.tensors.GeneralTensor.is_comb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_comb</span></code></a></dt><dd><p>Whether the tensor has comb (causal) structure.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.output_dim" title="qmetro.qmtensor.classes.tensors.GeneralTensor.output_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_dim</span></code></a></dt><dd><p>Output dimension, that is the product of the all output spaces dimensions.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.output_spaces" title="qmetro.qmtensor.classes.tensors.GeneralTensor.output_spaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_spaces</span></code></a></dt><dd><p>List of the output spaces.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.shape" title="qmetro.qmtensor.classes.tensors.GeneralTensor.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></dt><dd><p>Tensor shape, that is index ranges of self.spaces.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.choi_trace" title="qmetro.qmtensor.classes.tensors.GeneralTensor.choi_trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_trace</span></code></a>(*spaces[, full])</p></td>
<td><p>For Choi-like tensor compute partial trace of the Choi matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.contr" title="qmetro.qmtensor.classes.tensors.GeneralTensor.contr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">contr</span></code></a>(*others)</p></td>
<td><p>Contract tensors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.copy" title="qmetro.qmtensor.classes.tensors.GeneralTensor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.kron" title="qmetro.qmtensor.classes.tensors.GeneralTensor.kron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kron</span></code></a>(*others)</p></td>
<td><p>For Choi-like tensors it computes their Kronecker product and for other tensors it is just contraction where there are no doubled indices (no index gets contracted).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.respace" title="qmetro.qmtensor.classes.tensors.GeneralTensor.respace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">respace</span></code></a>([spaces, space_map, sdict, name])</p></td>
<td><p>Make a copy of self but with renamed spaces.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.choi_trace">
<span class="sig-name descname"><span class="pre">choi_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor.choi_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.choi_trace" title="Link to this definition"></a></dt>
<dd><p>For Choi-like tensor compute partial trace of the Choi matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong><strong>[</strong><strong>0</strong><strong>...</strong><strong>*</strong><strong>]</strong> (<em>Hashable</em>) – Spaces to be traced out.</p></li>
<li><p><strong>full</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True then computes the trace over all spaces and returns
a complex number, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Tensor of the result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor | complex</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.comb_structure">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">comb_structure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.comb_structure" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.contr">
<span class="sig-name descname"><span class="pre">contr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor.contr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.contr" title="Link to this definition"></a></dt>
<dd><p>Contract tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>others</strong><strong>[</strong><strong>0</strong><strong>...</strong><strong>*</strong><strong>]</strong> (<em>Tensor</em><em> | </em><em>Scalar</em>) – Tensors to be contracted with self.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Contraction result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.copy" title="Link to this definition"></a></dt>
<dd><p>Make a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy</strong> – Tensor copy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.counter">
<span class="sig-name descname"><span class="pre">counter</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.counter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.dimensions">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dimensions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.dimensions" title="Link to this definition"></a></dt>
<dd><p>Dimensions of the tensor spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dims</strong> – List of dimensions of self.spaces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.input_dim">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.input_dim" title="Link to this definition"></a></dt>
<dd><p>Input dimension, that is the product of the all input spaces
dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – Input dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.input_spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.input_spaces" title="Link to this definition"></a></dt>
<dd><p>List of the input spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_spaces</strong> – List of input spaces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[Hashable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.is_choi_like">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_choi_like</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.is_choi_like" title="Link to this definition"></a></dt>
<dd><p>Whether the tensor is Choi-like. The tensor is Choi-like if all its
spaces are physical.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_choi_like</strong> – Whether the tensor is Choi-like.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.is_comb">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_comb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.is_comb" title="Link to this definition"></a></dt>
<dd><p>Whether the tensor has comb (causal) structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_comb</strong> – Whether the tensor has comb structure.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.kron">
<span class="sig-name descname"><span class="pre">kron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor.kron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.kron" title="Link to this definition"></a></dt>
<dd><p>For Choi-like tensors it computes their Kronecker product and for
other tensors it is just contraction where there are no doubled
indices (no index gets contracted).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>others</strong><strong>[</strong><strong>0</strong><strong>...</strong><strong>*</strong><strong>]</strong> (<em>Tensor</em><em> | </em><em>Scalar</em>) – Tensors Kronecker multiplied with self.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Kronecker product.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.name_prefix">
<span class="sig-name descname"><span class="pre">name_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GENERAL</span> <span class="pre">TENSOR</span> <span class="pre">'</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.name_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.output_dim">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.output_dim" title="Link to this definition"></a></dt>
<dd><p>Output dimension, that is the product of the all output spaces
dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – Output dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.output_spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.output_spaces" title="Link to this definition"></a></dt>
<dd><p>List of the output spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_spaces</strong> – List of output spaces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[Hashable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.respace">
<span class="sig-name descname"><span class="pre">respace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><span class="pre">SpaceDict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><span class="pre">GeneralTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#GeneralTensor.respace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.respace" title="Link to this definition"></a></dt>
<dd><p>Make a copy of self but with renamed spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
self.spaces[i] -&gt; spaces[i]. If None then change of spaces will
be carried out using space_map, by default None.</p></li>
<li><p><strong>space_map</strong> (<em>Callable</em><em>[</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
space -&gt; space_map(space), by default None</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Space dictionary of the copy. If None then it will be
self.sdict, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the copy. If None then it will be self.name, by
default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>copy</strong> – New tensor with renamed spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor">GeneralTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.GeneralTensor.shape">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.GeneralTensor.shape" title="Link to this definition"></a></dt>
<dd><p>Tensor shape, that is index ranges of self.spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> – Tensor shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[int, …]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">ParamTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spaces:</span> <span class="pre">list[~collections.abc.Hashable],</span> <span class="pre">choi:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;,</span> <span class="pre">array:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">dchoi:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">darray:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">output_spaces:</span> <span class="pre">list[~collections.abc.Hashable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">comb_structure:</span> <span class="pre">list[tuple[list[~collections.abc.Hashable],</span> <span class="pre">list[~collections.abc.Hashable]]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstTensor</span></code></a></p>
<p>Class of parametrised tensor. It is a const tensor with additional
attribute ‘dtensor’ which represents its derivative over the
paramter in 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces.</p></li>
<li><p><strong>choi_matrix</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Choi matrix which from which the tensor will be constructed. If
None then it will be initialized from the array argument, by
default None.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>array</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor as numpy array, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name, by default None.</p></li>
<li><p><strong>dchoi_matrix</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Choi matrix which from which the dtensor will be constructed. If
None then it will be initialized from the darray argument, by
default None.</p></li>
<li><p><strong>darray</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Derivative as numpy array, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Tensor output spaces, by default None.</p></li>
<li><p><strong>comb_structure</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Comb (causal) structure in a form of [(input_0, output_0),
(input_1, output_1), …] where input_i (output_i) is a list
of input (output) spaces of the i-th tooth.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>comb_structure</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></dt><dd><p>Dimensions of the tensor spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dim</span></code></dt><dd><p>Input dimension, that is the product of the all input spaces dimensions.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.input_spaces" title="qmetro.qmtensor.classes.tensors.ParamTensor.input_spaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_spaces</span></code></a></dt><dd><p>List of the input spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_choi_like</span></code></dt><dd><p>Whether the tensor is Choi-like.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_comb</span></code></dt><dd><p>Whether the tensor has comb (causal) structure.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_dim</span></code></dt><dd><p>Output dimension, that is the product of the all output spaces dimensions.</p>
</dd>
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.output_spaces" title="qmetro.qmtensor.classes.tensors.ParamTensor.output_spaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_spaces</span></code></a></dt><dd><p>List of the output spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></dt><dd><p>Tensor shape, that is index ranges of self.spaces.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi</span></code>(spaces)</p></td>
<td><p>Compute Choi matrix for the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_T</span></code>(*spaces[, full])</p></td>
<td><p>Computes partial transposition of Choi-like tensor and for other tensors it does transpose-like reshuffling of entries on physcial spaces.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_matmul</span></code>(other)</p></td>
<td><p>For two Choi-like tensors compute the tensor of their Choi matrices multiplication.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_trace</span></code>(*spaces[, full])</p></td>
<td><p>For Choi-like tensor compute partial trace of the Choi matrix and return its tensor form.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.choi_transpose" title="qmetro.qmtensor.classes.tensors.ParamTensor.choi_transpose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_transpose</span></code></a>(*spaces[, full])</p></td>
<td><p>Computes partial transposition of Choi-like tensor and for other tensors it does transpose-like reshuffling of entries on physcial spaces.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">contr</span></code>(*others)</p></td>
<td><p>Contract tensors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.copy" title="qmetro.qmtensor.classes.tensors.ParamTensor.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.dchoi" title="qmetro.qmtensor.classes.tensors.ParamTensor.dchoi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dchoi</span></code></a>(spaces)</p></td>
<td><p>Compute derivative of Choi matrix for the Choi-like tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.dkrauses" title="qmetro.qmtensor.classes.tensors.ParamTensor.dkrauses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dkrauses</span></code></a>([input_spaces, output_spaces])</p></td>
<td><p>Computes Kraus operatiors of the Choi matrix of the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.from_const" title="qmetro.qmtensor.classes.tensors.ParamTensor.from_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_const</span></code></a>(tensor[, name])</p></td>
<td><p>Get a parametrized tensor from a constant tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_mps</span></code>(array, spaces[, sdict, ...])</p></td>
<td><p>Computess a constant tensor of density MPO element from the array of MPS element.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">krauses</span></code>([input_spaces, output_spaces])</p></td>
<td><p>Computes Kraus operators of the Choi matrix of the Choi-like tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kron</span></code>(*others)</p></td>
<td><p>For Choi-like tensors it computes their Kronecker product and for other tensors it is just contraction where there are no doubled indices (no index gets contracted).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.reorder" title="qmetro.qmtensor.classes.tensors.ParamTensor.reorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reorder</span></code></a>(new_spaces)</p></td>
<td><p>Change the order of spaces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.respace" title="qmetro.qmtensor.classes.tensors.ParamTensor.respace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">respace</span></code></a>([spaces, space_map, sdict, name, ...])</p></td>
<td><p>Make a copy of self but with renamed spaces.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.square_without" title="qmetro.qmtensor.classes.tensors.ParamTensor.square_without"><code class="xref py py-obj docutils literal notranslate"><span class="pre">square_without</span></code></a>(spaces)</p></td>
<td><p>Computes Choi matrix square on spaces different than given spaces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor.to_const" title="qmetro.qmtensor.classes.tensors.ParamTensor.to_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_const</span></code></a>(tensor[, name])</p></td>
<td><p>Discards the derivative and returns the constant tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_mps</span></code>(spaces[, cutoff])</p></td>
<td><p>Converts tensor form of density MPO component into MPS component(s).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_qchannel</span></code>([input_spaces, output_spaces])</p></td>
<td><p>Returns a quantum channel of the Choi matrix of the Choi-like tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_choi</span></code>(spaces, matrix)</p></td>
<td><p>Set tensor entries to make it Choi matrix equal to the given matrix.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.choi_transpose">
<span class="sig-name descname"><span class="pre">choi_transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.choi_transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.choi_transpose" title="Link to this definition"></a></dt>
<dd><p>Computes partial transposition of Choi-like tensor and for other
tensors it does transpose-like reshuffling of entries on
physcial spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True tranposes all spaces, by default False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transpostion</strong> – Tensor of the transposed matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor">ParamTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.comb_structure">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">comb_structure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.comb_structure" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.copy" title="Link to this definition"></a></dt>
<dd><p>Make a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy</strong> – Tensor copy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor">ParamTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.dchoi">
<span class="sig-name descname"><span class="pre">dchoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.dchoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.dchoi" title="Link to this definition"></a></dt>
<dd><p>Compute derivative of Choi matrix for the Choi-like tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – List of spaces defining the order of spaces of the result.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>matrix</strong> – Derivative of Choi matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.dkrauses">
<span class="sig-name descname"><span class="pre">dkrauses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.dkrauses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.dkrauses" title="Link to this definition"></a></dt>
<dd><p>Computes Kraus operatiors of the Choi matrix of the Choi-like
tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Input spaces. If None then self.input_spaces, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Output spaces. If None then self.output_spaces, by default
None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>krauses</strong> (<em>list[np.ndarray]</em>) – List of Kraus operators.</p></li>
<li><p><em>dkrause L list[np.ndarray]</em> – List of derivatives of Kraus operators.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.from_const">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.from_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.from_const" title="Link to this definition"></a></dt>
<dd><p>Get a parametrized tensor from a constant tensor. The derivative is
assumed to be 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><em>ConstTensor</em></a>) – Conastant tensor.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then tensor.name, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – The same tensor but with defined derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor">ParamTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.input_spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.input_spaces" title="Link to this definition"></a></dt>
<dd><p>List of the input spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_spaces</strong> – List of input spaces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[Hashable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.name_prefix">
<span class="sig-name descname"><span class="pre">name_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'PARAM</span> <span class="pre">TENSOR</span> <span class="pre">'</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.name_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.output_spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.output_spaces" title="Link to this definition"></a></dt>
<dd><p>List of the output spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_spaces</strong> – List of output spaces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[Hashable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.reorder">
<span class="sig-name descname"><span class="pre">reorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.reorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.reorder" title="Link to this definition"></a></dt>
<dd><p>Change the order of spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Spaces names in the new order.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – self</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor">ParamTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.respace">
<span class="sig-name descname"><span class="pre">respace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><span class="pre">SpaceDict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.respace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.respace" title="Link to this definition"></a></dt>
<dd><p>Make a copy of self but with renamed spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
self.spaces[i] -&gt; spaces[i]. If None then change of spaces
will be carried out using space_map, by default None.</p></li>
<li><p><strong>space_map</strong> (<em>Callable</em><em>[</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
space -&gt; space_map(space), by default None</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Space dictionary of the copy. If None then it will be
self.sdict, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the copy. If None then it will be self.name, by
default None.</p></li>
<li><p><strong>make_copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to make a copy of <cite>self.array</cite> and
<cite>self.dtensor.array</cite>, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>copy</strong> – New tensor with renamed spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor">ParamTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.square_without">
<span class="sig-name descname"><span class="pre">square_without</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.square_without"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.square_without" title="Link to this definition"></a></dt>
<dd><p>Computes Choi matrix square on spaces different than given spaces.</p>
<p>For tensor T[a0, a1, a2, a3] and spaces [a0, a1] computes a new
tensor U such that</p>
<blockquote>
<div><p>U[a0, a1].choi == T[a0, a1].choi &#64; T[a0, a1].choi.</p>
</div></blockquote>
<p>It can be used to compute matrix squares for tensor networks. For
example for physcial spaces p0, p1 and bond space b0 and tensors:</p>
<blockquote>
<div><p>V[p0, p1] = T[p0, b0] * U[b0, p1],</p>
</div></blockquote>
<p>it satifies:</p>
<blockquote>
<div><p>V.choi([p0, p1]) &#64; V.choi([p0, p1]) == (T.square_wiyhout([b0])
* U.square_wiyhout([b0])).choi([p0, p1]).</p>
</div></blockquote>
<p>Note that this requires T.square_wiyhout([b0]) to have two b0
spaces. This is solved by adding b0’ space using SpaceDictionar
primed method.</p>
<p>Only physical spaces can be squared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Spaces to be omitted.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Matrix square without given spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.ParamTensor.to_const">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_const</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><span class="pre">ParamTensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#ParamTensor.to_const"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.ParamTensor.to_const" title="Link to this definition"></a></dt>
<dd><p>Discards the derivative and returns the constant tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ParamTensor" title="qmetro.qmtensor.classes.tensors.ParamTensor"><em>ParamTensor</em></a><em> | </em><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><em>ConstTensor</em></a>) – Parametrized or constant tensor.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then tensor.name, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Tensor without the derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">SpaceDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dictionary connecting spaces to their dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the dictionary. If equal to ‘’ then the name will be
set to a number of previously existing quantum system. By
default ‘’.</p>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.irange" title="qmetro.qmtensor.classes.tensors.SpaceDict.irange"><code class="xref py py-obj docutils literal notranslate"><span class="pre">irange</span></code></a></dt><dd><p>Index range of spaces.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.arrange_bonds" title="qmetro.qmtensor.classes.tensors.SpaceDict.arrange_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arrange_bonds</span></code></a>(shape, dim[, prefix])</p></td>
<td><p>Add spaces with names:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.arrange_spaces" title="qmetro.qmtensor.classes.tensors.SpaceDict.arrange_spaces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arrange_spaces</span></code></a>(shape, dim[, prefix])</p></td>
<td><p>Add spaces with names:</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.choi_identity" title="qmetro.qmtensor.classes.tensors.SpaceDict.choi_identity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_identity</span></code></a>([spaces])</p></td>
<td><p>Creates Choi-like constant tensor of identity matrix with sdict=self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.ctensor" title="qmetro.qmtensor.classes.tensors.SpaceDict.ctensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ctensor</span></code></a>(spaces, **kwargs)</p></td>
<td><p>Creates constant tensor with sdict=self.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.get_dimension" title="qmetro.qmtensor.classes.tensors.SpaceDict.get_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dimension</span></code></a>(space)</p></td>
<td><p>Get space dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.make_primed" title="qmetro.qmtensor.classes.tensors.SpaceDict.make_primed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_primed</span></code></a>(*spaces)</p></td>
<td><p>Adds given spaces to the dictionary of primed spaces (self.primed_spaces).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.primed" title="qmetro.qmtensor.classes.tensors.SpaceDict.primed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">primed</span></code></a>(space)</p></td>
<td><p>For spaces returns space' where space' = (space, self.prime).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.set_bond" title="qmetro.qmtensor.classes.tensors.SpaceDict.set_bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_bond</span></code></a>(space, dim)</p></td>
<td><p>Set space dimension and mark it as bond space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.set_dimension" title="qmetro.qmtensor.classes.tensors.SpaceDict.set_dimension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_dimension</span></code></a>(space, dimension)</p></td>
<td><p>Set space dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.unprimed" title="qmetro.qmtensor.classes.tensors.SpaceDict.unprimed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unprimed</span></code></a>(space)</p></td>
<td><p>If space' is in self returns space else returns space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict.zero" title="qmetro.qmtensor.classes.tensors.SpaceDict.zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero</span></code></a>([spaces])</p></td>
<td><p>Creates constant tensor filled with zeros with sdict=self.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.arrange_bonds">
<span class="sig-name descname"><span class="pre">arrange_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'BOND'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.arrange_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.arrange_bonds" title="Link to this definition"></a></dt>
<dd><p>Add spaces with names:</p>
<blockquote>
<div><p>(prefix, i_0, …, i_r)</p>
</div></blockquote>
<p>for i_k = 0, …, n_k and mark them as bond spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>int</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – Shape of the index tuple (n_0, …, n_r).</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – Dimension of added spaces.</p></li>
<li><p><strong>prefix</strong> (<em>Hashable</em><em>, </em><em>optional</em>) – Prefix, by default ‘BOND’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>r-dimensional list of spaces names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.arrange_spaces">
<span class="sig-name descname"><span class="pre">arrange_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SPACE'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.arrange_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.arrange_spaces" title="Link to this definition"></a></dt>
<dd><p>Add spaces with names:</p>
<blockquote>
<div><p>(prefix, i_0, …, i_r)</p>
</div></blockquote>
<p>for i_k = 0, …, n_k.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>int</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – Shape of the index tuple (n_0, …, n_r).</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – Dimension of added spaces.</p></li>
<li><p><strong>prefix</strong> (<em>Hashable</em><em>, </em><em>optional</em>) – Prefix, by default ‘SPACE’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>r-dimensional list of spaces names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.choi_identity">
<span class="sig-name descname"><span class="pre">choi_identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.choi_identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.choi_identity" title="Link to this definition"></a></dt>
<dd><p>Creates Choi-like constant tensor of identity matrix with
sdict=self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em>) – Tensor spaces, by default empty list.</p></li>
<li><p><strong>**kwargs</strong> – Key-word arguments passed to ConstTensor constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Choi-like constant tensor of identity matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.counter">
<span class="sig-name descname"><span class="pre">counter</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.counter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.ctensor">
<span class="sig-name descname"><span class="pre">ctensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.ctensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.ctensor" title="Link to this definition"></a></dt>
<dd><p>Creates constant tensor with sdict=self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces.</p></li>
<li><p><strong>**kwargs</strong> – Key-word arguments passed to ConstTensor constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Added tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.get_dimension">
<span class="sig-name descname"><span class="pre">get_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.get_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.get_dimension" title="Link to this definition"></a></dt>
<dd><p>Get space dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>space</strong> (<em>str</em>) – Space name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dim</strong> – Space dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.irange">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">irange</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.irange" title="Link to this definition"></a></dt>
<dd><p>Index range of spaces. Index range for physical space is
its dimension squared and for bond space it is just its dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>irange</strong> – Dictionary of spaces and their ranges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[Hashable, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.make_primed">
<span class="sig-name descname"><span class="pre">make_primed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.make_primed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.make_primed" title="Link to this definition"></a></dt>
<dd><p>Adds given spaces to the dictionary of primed spaces
(self.primed_spaces).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.primed">
<span class="sig-name descname"><span class="pre">primed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Hashable</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.primed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.primed" title="Link to this definition"></a></dt>
<dd><p>For spaces returns space’ where space’ = (space, self.prime).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>space</strong> (<em>Hashable</em>) – Space name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_space</strong> – New space (space’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hashable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.set_bond">
<span class="sig-name descname"><span class="pre">set_bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.set_bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.set_bond" title="Link to this definition"></a></dt>
<dd><p>Set space dimension and mark it as bond space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<em>Hashable</em>) – Space name.</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – Space dimension.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.set_dimension">
<span class="sig-name descname"><span class="pre">set_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.set_dimension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.set_dimension" title="Link to this definition"></a></dt>
<dd><p>Set space dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<em>Hashable</em>) – Space name.</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – Space dimension.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.unprimed">
<span class="sig-name descname"><span class="pre">unprimed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Hashable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Hashable</span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.unprimed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.unprimed" title="Link to this definition"></a></dt>
<dd><p>If space’ is in self returns space else returns space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>space</strong> (<em>Hashable</em>) – Space name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>unprimed_space</strong> – Space name without a prime.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hashable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.SpaceDict.zero">
<span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#SpaceDict.zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.SpaceDict.zero" title="Link to this definition"></a></dt>
<dd><p>Creates constant tensor filled with zeros with sdict=self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces, by default empty list.</p></li>
<li><p><strong>**kwargs</strong> – Key-word arguments passed to ConstTensor constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Zero const tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">TensorNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors:</span> <span class="pre">list[~qmetro.qmtensor.classes.tensors.GeneralTensor</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">complex]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralTensor</span></code></a></p>
<p>Class of tensor network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> (<em>list</em><em>[</em><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><em>GeneralTensor</em></a><em>  |  </em><em>Scalar</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Nodes of the network (or other network), by default None.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Network name, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>comb_structure</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></dt><dd><p>Dimensions of the tensor spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dim</span></code></dt><dd><p>Input dimension, that is the product of the all input spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_spaces</span></code></dt><dd><p>List of the input spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_choi_like</span></code></dt><dd><p>Whether the tensor is Choi-like.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_comb</span></code></dt><dd><p>Whether the tensor has comb (causal) structure.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_dim</span></code></dt><dd><p>Output dimension, that is the product of the all output spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_spaces</span></code></dt><dd><p>List of the output spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></dt><dd><p>Tensor shape, that is index ranges of self.spaces.</p>
</dd>
<dt><strong>spaces</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_trace</span></code>(*spaces[, full])</p></td>
<td><p>For Choi-like tensor compute partial trace of the Choi matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.compress" title="qmetro.qmtensor.classes.tensors.TensorNetwork.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compress</span></code></a>([name, ignore])</p></td>
<td><p>Make those contraction of constant nodes that do not increase used memory space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.connected_components" title="qmetro.qmtensor.classes.tensors.TensorNetwork.connected_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connected_components</span></code></a>([subgraph, removed])</p></td>
<td><p>Get list of connected components.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">contr</span></code>(*others)</p></td>
<td><p>Contract tensors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.copy" title="qmetro.qmtensor.classes.tensors.TensorNetwork.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kron</span></code>(*others)</p></td>
<td><p>For Choi-like tensors it computes their Kronecker product and for other tensors it is just contraction where there are no doubled indices (no index gets contracted).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.neighbors" title="qmetro.qmtensor.classes.tensors.TensorNetwork.neighbors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">neighbors</span></code></a>(name)</p></td>
<td><p>Get set of neighbors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.plot" title="qmetro.qmtensor.classes.tensors.TensorNetwork.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>(**kwargs)</p></td>
<td><p>Plot the network using matplotlib.pyplot.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.remove" title="qmetro.qmtensor.classes.tensors.TensorNetwork.remove"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove</span></code></a>(names)</p></td>
<td><p>Remove tensors from the network.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.respace" title="qmetro.qmtensor.classes.tensors.TensorNetwork.respace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">respace</span></code></a>([spaces, space_map, qsystem, name])</p></td>
<td><p>Make a copy of self but with renamed spaces.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.compress">
<span class="sig-name descname"><span class="pre">compress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.compress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.compress" title="Link to this definition"></a></dt>
<dd><p>Make those contraction of constant nodes that do not increase
used memory space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the new tensor network, by default None.</p></li>
<li><p><strong>ignore</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Names of tensors that cannot be contracted, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compressed tensor network.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork">TensorNetwork</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.connected_components">
<span class="sig-name descname"><span class="pre">connected_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgraph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.connected_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.connected_components" title="Link to this definition"></a></dt>
<dd><p>Get list of connected components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subgraph</strong> (<em>set</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Nodes defining subgraph for which the computation is performed,
by default None.</p></li>
<li><p><strong>removed</strong> (<em>set</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Nodes assumed to be removed from the network, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>components</strong> – List of lists of names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[list[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.copy" title="Link to this definition"></a></dt>
<dd><p>Make a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copy</strong> – Tensor network copy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork">TensorNetwork</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.name_prefix">
<span class="sig-name descname"><span class="pre">name_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'TENSOR</span> <span class="pre">NETWORK</span> <span class="pre">'</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.name_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.neighbors">
<span class="sig-name descname"><span class="pre">neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.neighbors" title="Link to this definition"></a></dt>
<dd><p>Get set of neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – Node name.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>neighbors</strong> – Set of neighbors’ names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the network using matplotlib.pyplot.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.remove" title="Link to this definition"></a></dt>
<dd><p>Remove tensors from the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Names of the tensors to remove.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.respace">
<span class="sig-name descname"><span class="pre">respace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsystem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><span class="pre">SpaceDict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.TensorNetwork" title="qmetro.qmtensor.classes.tensors.TensorNetwork"><span class="pre">TensorNetwork</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#TensorNetwork.respace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.respace" title="Link to this definition"></a></dt>
<dd><p>Make a copy of self but with renamed spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
self.spaces[i] -&gt; spaces[i]. If None then change of spaces will
be carried out using space_map, by default None.</p></li>
<li><p><strong>space_map</strong> (<em>Callable</em><em>[</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
space -&gt; space_map(space), by default None</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Space dictionary of the copy. If None then it will be
self.sdict, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the copy. If None then it will be self.name, by
default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>copy</strong> – New tensor with renamed spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor">GeneralTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.TensorNetwork.spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.TensorNetwork.spaces" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qmetro.qmtensor.classes.tensors.</span></span><span class="sig-name descname"><span class="pre">VarTensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">spaces:</span> <span class="pre">list[~collections.abc.Hashable],</span> <span class="pre">sdict:</span> <span class="pre">~qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">=</span> <span class="pre">&lt;qmetro.qmtensor.classes.tensors.SpaceDict</span> <span class="pre">object&gt;,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">output_spaces:</span> <span class="pre">list[~collections.abc.Hashable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">is_unital:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">is_measurement:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">comb_structure:</span> <span class="pre">list[tuple[list[~collections.abc.Hashable],</span> <span class="pre">list[~collections.abc.Hashable]]]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#qmetro.qmtensor.classes.tensors.GeneralTensor" title="qmetro.qmtensor.classes.tensors.GeneralTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralTensor</span></code></a></p>
<p>Class of tensors that are optimized by iss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>]</em>) – Tensor spaces.</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em>, </em><em>optional</em>) – Space dictionary, by default DEFAULT_SDICT.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name, by default None.</p></li>
<li><p><strong>output_spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Tensor output spaces, by default None</p></li>
<li><p><strong>is_unital</strong> (<em>bool</em><em>, </em><em>optional</em>) – Unitality constraint, by default False.</p></li>
<li><p><strong>is_measurement</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether it is a measurment-like (SLD-like) variable, by default
False.</p></li>
<li><p><strong>comb_structure</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>list</em><em>[</em><em>Hashable</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Comb (causal) structure in a form of [(input_0, output_0),
(input_1, output_1), …] where input_i (output_i) is a list
of input (output) spaces of the i-th tooth.</p></li>
</ul>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>comb_structure</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></dt><dd><p>Dimensions of the tensor spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dim</span></code></dt><dd><p>Input dimension, that is the product of the all input spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_spaces</span></code></dt><dd><p>List of the input spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_choi_like</span></code></dt><dd><p>Whether the tensor is Choi-like.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_comb</span></code></dt><dd><p>Whether the tensor has comb (causal) structure.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_dim</span></code></dt><dd><p>Output dimension, that is the product of the all output spaces dimensions.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_spaces</span></code></dt><dd><p>List of the output spaces.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></dt><dd><p>Tensor shape, that is index ranges of self.spaces.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choi_trace</span></code>(*spaces[, full])</p></td>
<td><p>For Choi-like tensor compute partial trace of the Choi matrix.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">contr</span></code>(*others)</p></td>
<td><p>Contract tensors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kron</span></code>(*others)</p></td>
<td><p>For Choi-like tensors it computes their Kronecker product and for other tensors it is just contraction where there are no doubled indices (no index gets contracted).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_choi" title="qmetro.qmtensor.classes.tensors.VarTensor.random_choi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_choi</span></code></a>([name])</p></td>
<td><p>Draw random tensor of CPTP Choi matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_comb" title="qmetro.qmtensor.classes.tensors.VarTensor.random_comb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_comb</span></code></a>([name])</p></td>
<td><p>Draw random tensor of comb Choi matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_mps_element" title="qmetro.qmtensor.classes.tensors.VarTensor.random_mps_element"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_mps_element</span></code></a>([name])</p></td>
<td><p>Constant tensor of a density matrix MPO element from the random MPS element.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_sld" title="qmetro.qmtensor.classes.tensors.VarTensor.random_sld"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_sld</span></code></a>([name])</p></td>
<td><p>Constant tensor of random SLD matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor.respace" title="qmetro.qmtensor.classes.tensors.VarTensor.respace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">respace</span></code></a>([spaces, space_map, sdict, name])</p></td>
<td><p>Make a copy of self but with renamed spaces.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.name_prefix">
<span class="sig-name descname"><span class="pre">name_prefix</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'VAR</span> <span class="pre">TENSOR</span> <span class="pre">'</span></em><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.name_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.random_choi">
<span class="sig-name descname"><span class="pre">random_choi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor.random_choi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_choi" title="Link to this definition"></a></dt>
<dd><p>Draw random tensor of CPTP Choi matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then self.name, by default None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Random tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.random_comb">
<span class="sig-name descname"><span class="pre">random_comb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor.random_comb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_comb" title="Link to this definition"></a></dt>
<dd><p>Draw random tensor of comb Choi matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then self.name, by default None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Random tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.random_mps_element">
<span class="sig-name descname"><span class="pre">random_mps_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor.random_mps_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_mps_element" title="Link to this definition"></a></dt>
<dd><p>Constant tensor of a density matrix MPO element from the random MPS
element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then self.name, by default None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Random tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.random_sld">
<span class="sig-name descname"><span class="pre">random_sld</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor"><span class="pre">ConstTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor.random_sld"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.random_sld" title="Link to this definition"></a></dt>
<dd><p>Constant tensor of random SLD matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Tensor name. If None then self.name, by default None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tensor</strong> – Random SLD matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.ConstTensor" title="qmetro.qmtensor.classes.tensors.ConstTensor">ConstTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qmetro.qmtensor.classes.tensors.VarTensor.respace">
<span class="sig-name descname"><span class="pre">respace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Hashable</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><span class="pre">SpaceDict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor"><span class="pre">VarTensor</span></a></span></span><a class="reference internal" href="_modules/qmetro/qmtensor/classes/tensors.html#VarTensor.respace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qmetro.qmtensor.classes.tensors.VarTensor.respace" title="Link to this definition"></a></dt>
<dd><p>Make a copy of self but with renamed spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spaces</strong> (<em>list</em><em>[</em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
self.spaces[i] -&gt; spaces[i]. If None then change of spaces will
be carried out using space_map, by default None.</p></li>
<li><p><strong>space_map</strong> (<em>Callable</em><em>[</em><em>[</em><em>Hashable</em><em>]</em><em>, </em><em>Hashable</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – The change of spaces will take the form
space -&gt; space_map(space), by default None</p></li>
<li><p><strong>sdict</strong> (<a class="reference internal" href="#qmetro.qmtensor.classes.tensors.SpaceDict" title="qmetro.qmtensor.classes.tensors.SpaceDict"><em>SpaceDict</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Space dictionary of the copy. If None then it will be
self.sdict, by default None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Name of the copy. If None then it will be self.name, by
default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>copy</strong> – New tensor with renamed spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#qmetro.qmtensor.classes.tensors.VarTensor" title="qmetro.qmtensor.classes.tensors.VarTensor">VarTensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qmetro.qmtensor.classes">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-qmetro.qmtensor.classes" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qmetro.qmtensor.html" class="btn btn-neutral float-left" title="qmetro.qmtensor package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qmetro.qmtensor.creators.html" class="btn btn-neutral float-right" title="qmetro.qmtensor.creators package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Piotr Dulian.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>